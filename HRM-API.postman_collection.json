{
  "info": {
    "name": "HRM System API - SECURED üîí",
    "description": "Complete API collection for HRM System with Authentication\n\n‚ö†Ô∏è QUAN TR·ªåNG:\n1. B·∫≠t Cookies trong Postman: Settings ‚Üí General ‚Üí Enable cookies\n2. Ph·∫£i login TR∆Ø·ªöC khi test c√°c API kh√°c\n3. Admin routes (DELETE) c·∫ßn login v·ªõi admin account\n\nüîê Test accounts:\n- Admin: username=admin, password=123456\n- User: username=user, password=123456",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost/ASM-HRM/backend/api.php",
      "type": "string"
    }
  ],
  "auth": {
    "type": "noauth"
  },
  "item": [
    {
      "name": "‚ö†Ô∏è START HERE - Authentication",
      "description": "ÔøΩ B·∫ÆT BU·ªòC: Ph·∫£i login tr∆∞·ªõc khi test c√°c API kh√°c!\n\n‚úÖ C√ÅCH D√ôNG:\n1. B·∫≠t Cookies: Settings ‚Üí General ‚Üí Enable cookies\n2. Ch·∫°y \"Login\" request\n3. Postman t·ª± ƒë·ªông l∆∞u session cookie\n4. Test c√°c API kh√°c (s·∫Ω t·ª± ƒë·ªông g·ª≠i cookie)\n\nÔøΩüîê Test accounts:\n- Admin: admin/123456 (c√≥ quy·ªÅn DELETE)\n- User: user/123456 (kh√¥ng c√≥ quy·ªÅn DELETE)",
      "item": [
        {
          "name": "‚úÖ Login (Admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// T·ª± ƒë·ªông ki·ªÉm tra login th√†nh c√¥ng",
                  "pm.test(\"Login successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "});",
                  "",
                  "pm.test(\"Session cookie ƒë∆∞·ª£c set\", function () {",
                  "    pm.expect(pm.cookies.has('PHPSESSID')).to.be.true;",
                  "});",
                  "",
                  "// Hi·ªÉn th·ªã th√¥ng b√°o",
                  "console.log('‚úÖ ƒê√£ login th√†nh c√¥ng! Session cookie ƒë√£ ƒë∆∞·ª£c l∆∞u.');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=auth/login",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/login"
                }
              ]
            },
            "description": "üîê Login v·ªõi admin account\n\nAccount: admin/123456\nQuy·ªÅn: Full access (bao g·ªìm DELETE)"
          },
          "response": []
        },
        {
          "name": "Login (User th∆∞·ªùng)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Login successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "});",
                  "",
                  "console.log('‚úÖ ƒê√£ login user th∆∞·ªùng. Kh√¥ng c√≥ quy·ªÅn DELETE.');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"user\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=auth/login",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/login"
                }
              ]
            },
            "description": "üîê Login v·ªõi user account\n\nAccount: user/123456\nQuy·ªÅn: Ch·ªâ GET/POST/PUT (KH√îNG c√≥ quy·ªÅn DELETE)"
          },
          "response": []
        },
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"newuser\",\n  \"password\": \"password123\",\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=auth/register",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/register"
                }
              ]
            },
            "description": "üìù ƒêƒÉng k√Ω t√†i kho·∫£n m·ªõi\n\n‚ö†Ô∏è Public endpoint - kh√¥ng c·∫ßn login"
          },
          "response": []
        },
        {
          "name": "Check Session",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData.logged_in) {",
                  "    console.log('‚úÖ ƒê√£ login: ' + jsonData.username);",
                  "    console.log('Role: ' + (jsonData.role || 'user'));",
                  "} else {",
                  "    console.log('‚ùå Ch∆∞a login - Vui l√≤ng login tr∆∞·ªõc!');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=auth/session",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/session"
                }
              ]
            },
            "description": "üîç Ki·ªÉm tra tr·∫°ng th√°i session hi·ªán t·∫°i\n\n‚ö†Ô∏è Public endpoint - kh√¥ng c·∫ßn login"
          },
          "response": []
        },
        {
          "name": "Logout",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Logout successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "});",
                  "",
                  "console.log('‚úÖ ƒê√£ logout. Session ƒë√£ b·ªã x√≥a.');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=auth/logout",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/logout"
                }
              ]
            },
            "description": "üö™ ƒêƒÉng xu·∫•t v√† x√≥a session"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üë• Employees (Protected)",
      "description": "üîí C·∫¶N LOGIN tr∆∞·ªõc khi test!\n\n‚úÖ GET/POST/PUT: C·∫ßn login (admin ho·∫∑c user)\nüî¥ DELETE: CH·ªà admin m·ªõi ƒë∆∞·ª£c ph√©p",
      "item": [
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=auth/login",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/login"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"newuser\",\n  \"password\": \"password123\",\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=auth/register",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/register"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Check Session",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=auth/session",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/session"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=auth/logout",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "auth/logout"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üë• Employees",
      "item": [
        {
          "name": "Get All Employees",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 401) {",
                  "    console.log('‚ùå CH∆ØA LOGIN! Vui l√≤ng login tr∆∞·ªõc.');",
                  "} else if (pm.response.code === 200) {",
                  "    console.log('‚úÖ Success! B·∫°n ƒë√£ login.');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=employees",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees"
                }
              ]
            },
            "description": "üìã L·∫•y danh s√°ch t·∫•t c·∫£ nh√¢n vi√™n\n\nüîí C·∫ßn login: ‚úÖ\nüîë Admin only: ‚ùå"
          },
          "response": []
        },
        {
          "name": "Get Employee by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=employees/1",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees/1"
                }
              ]
            },
            "description": "üë§ L·∫•y th√¥ng tin nh√¢n vi√™n theo ID\n\nüîí C·∫ßn login: ‚úÖ\nüîë Admin only: ‚ùå"
          },
          "response": []
        },
        {
          "name": "Create Employee",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Nguyen Van A\",\n  \"email\": \"nguyenvana@example.com\",\n  \"phone\": \"0123456789\",\n  \"position_id\": 1,\n  \"department_id\": 1,\n  \"hire_date\": \"2024-01-15\",\n  \"salary\": 15000000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=employees",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees"
                }
              ]
            },
            "description": "‚ûï T·∫°o nh√¢n vi√™n m·ªõi\n\nüîí C·∫ßn login: ‚úÖ\nüîë Admin only: ‚ùå"
          },
          "response": []
        },
        {
          "name": "Update Employee",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Nguyen Van A Updated\",\n  \"email\": \"nguyenvana.new@example.com\",\n  \"phone\": \"0987654321\",\n  \"position_id\": 2,\n  \"department_id\": 1,\n  \"salary\": 18000000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=employees/1",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees/1"
                }
              ]
            },
            "description": "‚úèÔ∏è C·∫≠p nh·∫≠t th√¥ng tin nh√¢n vi√™n\n\nüîí C·∫ßn login: ‚úÖ\nüîë Admin only: ‚ùå"
          },
          "response": []
        },
        {
          "name": "üî¥ Delete Employee (Admin Only)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 403) {",
                  "    console.log('üî¥ FORBIDDEN! Ch·ªâ admin m·ªõi c√≥ quy·ªÅn x√≥a.');",
                  "    console.log('üí° Tip: Login l·∫°i v·ªõi admin account.');",
                  "} else if (pm.response.code === 401) {",
                  "    console.log('‚ùå CH∆ØA LOGIN! Vui l√≤ng login tr∆∞·ªõc.');",
                  "} else if (pm.response.code === 200) {",
                  "    console.log('‚úÖ Success! B·∫°n l√† admin.');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=employees/1",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees/1"
                }
              ]
            },
            "description": "üóëÔ∏è X√≥a nh√¢n vi√™n\n\nüîí C·∫ßn login: ‚úÖ\nüî¥ Admin only: ‚úÖ (CH·ªà ADMIN)\n\n‚ö†Ô∏è N·∫øu login v·ªõi user th∆∞·ªùng ‚Üí 403 Forbidden"
          },
          "response": []
        },
        {
          "name": "Search Employees",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"keyword\": \"nguyen\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=employees/search",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees/search"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Employee Stats",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=employees/stats",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "employees/stats"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üè¢ Departments",
      "item": [
        {
          "name": "Get All Departments",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=departments",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "departments"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Create Department",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Ph√≤ng Marketing\",\n  \"description\": \"Ph√≤ng Marketing v√† Truy·ªÅn th√¥ng\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=departments",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "departments"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update Department",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Ph√≤ng Marketing & Sales\",\n  \"description\": \"Ph√≤ng Marketing v√† Kinh doanh\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=departments/1",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "departments/1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Delete Department",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=departments/1",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "departments/1"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üíº Positions",
      "item": [
        {
          "name": "Get All Positions",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=positions",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "positions"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "‚è∞ Attendance",
      "item": [
        {
          "name": "Check In",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"employee_id\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=attendance/checkin",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "attendance/checkin"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Check Out",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"employee_id\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=attendance/checkout",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "attendance/checkout"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Today Count",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=attendance/today-count",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "attendance/today-count"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üèñÔ∏è Leave Management",
      "item": [
        {
          "name": "Get All Leaves",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=leaves",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "leaves"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Request Leave",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"employee_id\": 1,\n  \"leave_type\": \"annual\",\n  \"start_date\": \"2024-02-01\",\n  \"end_date\": \"2024-02-03\",\n  \"reason\": \"Ngh·ªâ ph√©p h·∫±ng nƒÉm\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=leaves",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "leaves"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Approve Leave",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"leave_id\": 1,\n  \"status\": \"approved\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=leaves/approve",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "leaves/approve"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Pending Count",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=leaves/pending-count",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "leaves/pending-count"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üìä Performance Reviews",
      "item": [
        {
          "name": "Get All Reviews",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}?path=reviews",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "reviews"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Create Review",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"employee_id\": 1,\n  \"reviewer_id\": 2,\n  \"review_date\": \"2024-01-31\",\n  \"rating\": 4.5,\n  \"comments\": \"L√†m vi·ªác t·ªët, c√≥ tinh th·∫ßn tr√°ch nhi·ªám\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}?path=reviews",
              "host": ["{{baseUrl}}"],
              "query": [
                {
                  "key": "path",
                  "value": "reviews"
                }
              ]
            }
          },
          "response": []
        }
      ]
    }
  ]
}
